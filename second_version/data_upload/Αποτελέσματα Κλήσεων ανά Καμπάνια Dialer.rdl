<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Body>
    <ReportItems>
      <Tablix Name="Tablix1">
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>2.5cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>5.01354cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>5cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>6.00542cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>4.21979cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>3.87583cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>3.50542cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>3.90229cm</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>0.6cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox1">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Κωδ. ΕΣ</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontSize>11pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox1</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>#1c3a70</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox3">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Διακριτικος </Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontSize>11pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox3</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>#1c3a70</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox5">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Επωνυμία </Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontSize>11pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox5</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>#1c3a70</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox9">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>ΣΔ</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontSize>11pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox9</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>#1c3a70</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox7">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Αποτέλεσμα Κλήσης</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontSize>11pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox7</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>#1c3a70</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox13">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Αιτία Αποτελέσματος</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontSize>11pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox13</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>#1c3a70</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox15">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Ημ/νία Τελ. Επανάκλησης</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontSize>11pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox15</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>#1c3a70</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox2">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Ημ/νία Τελ. Αποτελ. Κλήσης</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontSize>11pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox2</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>#1c3a70</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.6cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Κωδ__ΕΣ">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Κωδ__ΕΣ.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Κωδ__ΕΣ</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Διακριτικος_ΕΣ">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Διακριτικος_ΕΣ.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Διακριτικος_ΕΣ</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Φορολογική_Επωνυμία_ΕΣ">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Φορολογική_Επωνυμία_ΕΣ.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Φορολογική_Επωνυμία_ΕΣ</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="ΣΔ">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!ΣΔ.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>ΣΔ</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Αποτέλεσμα_Κλήσης">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Αποτέλεσμα_Κλήσης.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Αποτέλεσμα_Κλήσης</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Αιτία_Αποτελέσματος">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Αιτία_Αποτελέσματος.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Αιτία_Αποτελέσματος</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Ημ_νια_Τελ__Επανάκλησης">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Ημ_νια_Τελ__Επανάκλησης.Value</Value>
                              <Style>
                                <Format>dd/MM/yyyy HH:mm:ss</Format>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Ημ_νια_Τελ__Επανάκλησης</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="CreatedOn">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!CreatedOn.Value</Value>
                              <Style>
                                <Format>dd/MM/yyyy HH:mm:ss</Format>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>CreatedOn</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <KeepWithGroup>After</KeepWithGroup>
            </TablixMember>
            <TablixMember>
              <Group Name="Details" />
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <DataSetName>Main</DataSetName>
        <Top>0.9525cm</Top>
        <Left>0.00001cm</Left>
        <Height>1.2cm</Height>
        <Width>34.02229cm</Width>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Tablix>
      <Textbox Name="textbox1">
        <CanGrow>true</CanGrow>
        <KeepTogether>true</KeepTogether>
        <Paragraphs>
          <Paragraph>
            <TextRuns>
              <TextRun>
                <Value>Dialer Call Results </Value>
                <Style>
                  <FontFamily>Tahoma</FontFamily>
                  <FontSize>18pt</FontSize>
                  <Color>#1c3a70</Color>
                </Style>
              </TextRun>
              <TextRun>
                <Value>// </Value>
                <Style>
                  <FontFamily>Tahoma</FontFamily>
                  <FontSize>18pt</FontSize>
                  <Color>Maroon</Color>
                </Style>
              </TextRun>
              <TextRun>
                <Value>=Parameters!Campaign.Label</Value>
                <Style>
                  <FontFamily>Tahoma</FontFamily>
                  <FontSize>18pt</FontSize>
                  <Color>#1c3a70</Color>
                </Style>
              </TextRun>
            </TextRuns>
            <Style />
          </Paragraph>
        </Paragraphs>
        <rd:DefaultName>textbox1</rd:DefaultName>
        <Height>0.33in</Height>
        <Width>13.3946in</Width>
        <ZIndex>1</ZIndex>
        <Style>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
      </Textbox>
      <Textbox Name="Textbox4">
        <CanGrow>true</CanGrow>
        <KeepTogether>true</KeepTogether>
        <Paragraphs>
          <Paragraph>
            <TextRuns>
              <TextRun>
                <Value>DialerCallResults.rdl</Value>
                <Style>
                  <FontSize>8pt</FontSize>
                  <Color>Silver</Color>
                </Style>
              </TextRun>
            </TextRuns>
            <Style />
          </Paragraph>
        </Paragraphs>
        <rd:DefaultName>Textbox4</rd:DefaultName>
        <Top>2.23364cm</Top>
        <Left>0.04974cm</Left>
        <Height>0.51689cm</Height>
        <Width>3.42604cm</Width>
        <ZIndex>2</ZIndex>
        <Visibility>
          <Hidden>true</Hidden>
        </Visibility>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
      </Textbox>
    </ReportItems>
    <Height>1.08289in</Height>
    <Style />
  </Body>
  <Width>13.39461in</Width>
  <Page>
    <PageHeight>29.7cm</PageHeight>
    <PageWidth>21cm</PageWidth>
    <LeftMargin>2cm</LeftMargin>
    <RightMargin>2cm</RightMargin>
    <TopMargin>2cm</TopMargin>
    <BottomMargin>2cm</BottomMargin>
    <ColumnSpacing>0.13cm</ColumnSpacing>
    <Style />
  </Page>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource1">
      <DataSourceReference>YPS</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>2d7d38b9-54dd-4502-8694-6c1b9deb113a</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="Main">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@Campaign">
            <Value>=Parameters!Campaign.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>IF OBJECT_ID('tempdb..#CurrentTask') IS NOT NULL
    DROP TABLE #CurrentTask


select dbp.BusinessPointCode
      ,CurPrTl.Outcome 
      ,CurPrTl.Timestamp
      ,CurPrTl.Text
      ,CurPrT.id as ts_id
      ,CurCs.id as cs_id
  into #CurrentTask
  from DialerTask dt 
  join DialerBusinessPoint dbp on dt.BusinessPointID = dbp.BusinessPointID
  join Task CurTs on dt.CurrentTaskID = CurTs.ID -- current Task
  join [Case] CurCs on CurCs.ID = CurTs.CaseID -- current Case
  join [Case] CurMcs on CurCs.MasterCaseID = CurMcs.ID -- MasterCase
  join Task CurPrT on Curmcs.ID = CurPrT.CaseID -- all tasks under the MasterCase
  join TargetGroupItemValue tgiv on tgiv.ID = CurMcs.ContextEntityID and CurMcs.ContextEntityType = 'TGIV'
  left join TaskLog CurPrTl on CurPrTl.TaskID = CurPrT.id 
  
  where dt.DialerCampaignID = @Campaign
    and CurPrTl.Timestamp &gt;= dt.ExportDate
   -- and dbp.BusinessPointCode in (1003919)--select * from dialercampaign
    and (CurPrT.TaskTypeID in (146,151,154,313,173,258,299,307) --all tasktypes that can result to outcomes 'ΑΔΥΝ','ΑΡΝΕ','ΑΡΝ','Επανάκληση'
    and CurPrTl.Outcome in ('ΑΔΥΝ','ΑΡΝΕ','ΑΡΝ','Επανάκληση'/*,'ΑΠΟΔΠ','ΑΝΣΥ'*/)
    and CurPrTl.Outcome is not null 
    and CurPrTl.Text is not null)
or (dt.DialerCampaignID = @Campaign
   -- and dbp.BusinessPointCode in (1003919)
    and (CurPrT.TaskTypeID in (146,151,154,313,173,258,299,307) --all tasktypes that can result to outcomes 'ΑΔΥΝ','ΑΡΝΕ','ΑΡΝ','Επανάκληση'
    and CurPrTl.Outcome in ('ΑΠΟΔΠ','ΑΝΣΥ')
    and CurPrTl.Outcome is not null )) 
    
    
    
    --and tgiv.ContractID is null --contracts
--select * from #CurrentTask 
--select * from TaskLog tl where tl.TaskID = 10608094
--select * from Task t where t.ID = 10862785
--select distinct tl.Outcome from TaskLog tl where tl.DMTable = '1065'


 
 
   
--All cases with Ranking   
 IF OBJECT_ID('tempdb..#aa') IS NOT NULL
    DROP TABLE #aa   
   
 select BusinessPointCode
      ,Outcome 
      ,Timestamp
      ,Text
      ,ts_id
      ,cs_id
      ,RANK() over (partition by BusinessPointCode order by ts_id) as TaskRnk
      ,RANK() over (partition by BusinessPointCode/*ts_id*/ order by timestamp) as DateRnk 
      into #aa
   from   #CurrentTask--#aai
   
   --select * from #aa where BusinessPointCode  =1976495
   
   
 IF OBJECT_ID('tempdb..#bbi') IS NOT NULL
    DROP TABLE #bbi   
   
   
--Max Tasks   
    
    select aa.BusinessPointCode,
           aa.cs_id,
           MAX(TaskRnk) as TaskRnk--,
           --MAX(DateRnk) as DateRnk
           --DateRnk
      into #bbi     
      from #aa aa
      group by aa.BusinessPointCode,
           aa.cs_id--,
           --DateRnk
           
               --select * from #bbi
    
           
  --Previous Task  
   IF OBJECT_ID('tempdb..#bbi2') IS NOT NULL
    DROP TABLE #bbi2          
       
     select aa.BusinessPointCode,
           aa.cs_id,
           MAX(TaskRnk)-1 as TaskRnk--,
           --MAX(DateRnk) as DateRnk
           --DateRnk
      into #bbi2     
      from #aa aa
      group by aa.BusinessPointCode,
           aa.cs_id--,          
 
--select * from #bbi2 
    
 IF OBJECT_ID('tempdb..#bb') IS NOT NULL
    DROP TABLE #bb        
           
--Max dates 
     select aa.BusinessPointCode,
           aa.cs_id,
           aa.TaskRnk,
           MAX(#aa.DateRnk) as DateRnk
           
      into #bb     
      from #bbi aa
      join #aa on #aa.BusinessPointCode = aa.BusinessPointCode
              and #aa.TaskRnk = aa.TaskRnk
      group by aa.BusinessPointCode,
           aa.cs_id,
           aa.TaskRnk          
           
           
--select * from #bb 

 IF OBJECT_ID('tempdb..#tmp') IS NOT NULL
    DROP TABLE #tmp      


select distinct --dbp.BusinessPointCode
      bp.Code as 'Κωδ. ΕΣ'
      ,bp.Name as 'Διακριτικος ΕΣ'
      ,bp.BrandName as 'Φορολογική Επωνυμία ΕΣ'
      ,'['+usr.SalesCode+'] '+usr.LastName +' '+ usr.FirstName as 'ΣΔ'
      ,case when aa.Outcome  = 'ΑΔΥΝ' and aa.Text = 'Fax' then aaa.Outcome--previous task
            when aa.Outcome  = 'ΑΔΥΝ' and aa.Text = 'Δεν απαντά' then aaa.Outcome
            when aa.Outcome  = 'ΑΔΥΝ' and aa.Text = 'Επανάκληση' then aaa.Outcome
            when aa.Outcome  = 'ΑΔΥΝ' and aa.Text = 'Τηλεφωνητής' then aaa.Outcome  
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Fax' then aaa.Outcome
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Άμεση άρνηση' then aaa.Outcome
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Δεν απαντά' then aaa.Outcome
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Επανάκληση' then aaa.Outcome
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Τηλεφωνητής' then aaa.Outcome
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Κόλλημα Συμβούλου' then aaa.Outcome
            when aa.Outcome  = 'Επανάκληση' and aa.Text = 'Επανάκληση' then aaa.Outcome
            when aa.Outcome  = 'Επανάκληση' and aa.Text = 'Κόλλημα Συμβούλου' then aaa.Outcome
            when aa.Outcome  = 'Επανάκληση' and aa.Text = '' then aaa.Outcome
            when aa.Outcome  = 'Επανάκληση' and aa.Text = '-' then aaa.Outcome
            when aa.Outcome  = 'Επανάκληση' and aa.Text IS null then aaa.Outcome--previous task end--  
            when aa.Outcome  = 'ΑΔΥΝ' then 'Αδυναμία εύρεσης πελάτη' 
            when aa.Outcome  = 'ΑΡΝ' then 'Άρνηση συνεργασίας' 
            when aa.Outcome = 'ΑΡΝΕ' then 'Άρνηση επικοινωνίας'
            when /*tgiv.AltOfferID IS Not null*/ aa.Outcome = 'ΑΠΟΔΠ' OR aa.Outcome = 'ΑΝΣΥ' then 'Αποδοχή Πρότασης' 
            else aa.Outcome end as 'Αποτέλεσμα Κλήσης'
      ,case --when tgiv.AltOfferID IS Not null then null
            when aa.Outcome  = 'ΑΔΥΝ' and aa.Text = 'Fax' then aaa.Text--previous task
            when aa.Outcome  = 'ΑΔΥΝ' and aa.Text = 'Δεν απαντά' then aaa.Text
            when aa.Outcome  = 'ΑΔΥΝ' and aa.Text = 'Επανάκληση' then aaa.Text
            when aa.Outcome  = 'ΑΔΥΝ' and aa.Text = 'Τηλεφωνητής' then aaa.Text  
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Fax' then aaa.Text
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Άμεση άρνηση' then aaa.Text
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Δεν απαντά' then aaa.Text
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Επανάκληση' then aaa.Text
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Τηλεφωνητής' then aaa.Text
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Κόλλημα Συμβούλου' then aaa.Text
            when aa.Outcome  = 'Επανάκληση' and aa.Text = 'Επανάκληση' then aaa.Text
            when aa.Outcome  = 'Επανάκληση' and aa.Text = 'Κόλλημα Συμβούλου' then aaa.Text
            when aa.Outcome  = 'Επανάκληση' and aa.Text = '' then aaa.Text
            when aa.Outcome  = 'Επανάκληση' and aa.Text = '-' then aaa.Text
            when aa.Outcome  = 'Επανάκληση' and aa.Text IS null then aaa.Text--previous task end--  
            --when aa.Outcome  = 'ΑΔΥΝ' then 'Αδυναμία εύρεσης πελάτη' 
            --when aa.Outcome  = 'ΑΡΝ' then 'Άρνηση συνεργασίας' 
            --when aa.Outcome = 'ΑΡΝΕ' then 'Άρνηση επικοινωνίας'    
            else aa.text end as 'Αιτία Αποτελέσματος'
      ,case when tgiv.AltOfferID IS Not null then null
            when aa.Outcome  = 'ΑΔΥΝ' and aa.Text = 'Fax' and aaa.Outcome = 'Επανάκληση' then null--previous task
            when aa.Outcome  = 'ΑΔΥΝ' and aa.Text = 'Δεν απαντά' and aaa.Outcome = 'Επανάκληση' then null
            when aa.Outcome  = 'ΑΔΥΝ' and aa.Text = 'Επανάκληση' and aaa.Outcome = 'Επανάκληση' then null
            when aa.Outcome  = 'ΑΔΥΝ' and aa.Text = 'Τηλεφωνητής' and aaa.Outcome = 'Επανάκληση' then null
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Fax' and aaa.Outcome = 'Επανάκληση' then null
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Άμεση άρνηση' and aaa.Outcome = 'Επανάκληση' then null
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Δεν απαντά' and aaa.Outcome = 'Επανάκληση' then null
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Επανάκληση' and aaa.Outcome = 'Επανάκληση' then null
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Τηλεφωνητής' and aaa.Outcome = 'Επανάκληση' then null
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Κόλλημα Συμβούλου' and aaa.Outcome = 'Επανάκληση' then null
            when aa.Outcome  = 'Επανάκληση' and aa.Text = 'Επανάκληση' and aaa.Outcome = 'Επανάκληση' then null
            when aa.Outcome  = 'Επανάκληση' and aa.Text = 'Κόλλημα Συμβούλου' and aaa.Outcome = 'Επανάκληση' then null
            when aa.Outcome  = 'Επανάκληση' and aa.Text = '' and aaa.Outcome = 'Επανάκληση' then null
            when aa.Outcome  = 'Επανάκληση' and aa.Text = '-' and aaa.Outcome = 'Επανάκληση' then null
            when aa.Outcome  = 'Επανάκληση' and aa.Text IS null and aaa.Outcome = 'Επανάκληση' then null
            when aa.Outcome = 'Επανάκληση' and aa.Text IN ('Άλλαξε Γνώμη ο Πελάτης','Θα το σκεφτεί','Έλειπε ο υπεύθυνος') then tgiv.RecallTime
            else null end as 'Ημ/νια Τελ. Επανάκλησης'
      ,case when aa.Outcome  = 'ΑΔΥΝ' and aa.Text = 'Fax' then aaa.Timestamp--previous task
            when aa.Outcome  = 'ΑΔΥΝ' and aa.Text = 'Δεν απαντά' then aaa.Timestamp
            when aa.Outcome  = 'ΑΔΥΝ' and aa.Text = 'Επανάκληση' then aaa.Timestamp
            when aa.Outcome  = 'ΑΔΥΝ' and aa.Text = 'Τηλεφωνητής' then aaa.Timestamp  
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Fax' then aaa.Timestamp
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Άμεση άρνηση' then aaa.Timestamp
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Δεν απαντά' then aaa.Timestamp
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Επανάκληση' then aaa.Timestamp
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Τηλεφωνητής' then aaa.Timestamp
            when aa.Outcome  = 'ΑΡΝ' and aa.Text = 'Κόλλημα Συμβούλου' then aaa.Timestamp
            when aa.Outcome  = 'Επανάκληση' and aa.Text = 'Επανάκληση' then aaa.Timestamp
            when aa.Outcome  = 'Επανάκληση' and aa.Text = 'Κόλλημα Συμβούλου' then aaa.Timestamp
            when aa.Outcome  = 'Επανάκληση' and aa.Text = '' then aaa.Timestamp
            when aa.Outcome  = 'Επανάκληση' and aa.Text = '-' then aaa.Timestamp
            when aa.Outcome  = 'Επανάκληση' and aa.Text IS null then aaa.Timestamp--previous task end--  
            when aa.Outcome  = 'ΑΔΥΝ' then aa.Timestamp 
            when aa.Outcome  = 'ΑΡΝ' then aa.Timestamp
            when aa.Outcome = 'ΑΡΝΕ' then aa.Timestamp
            when aa.Outcome = 'ΑΠΟΔΠ' OR aa.Outcome = 'ΑΝΣΥ' then aa.Timestamp
            else aa.Timestamp end as CreatedOn
            --,tgiv2.id
            --,tgiv.id,b.taskrnk,bb.taskrnk as bb_taskrnk,aa.ts_id, aaa.ts_id AS aaa_ts_id,tgiv2.RecallTime

  into #tmp    
  from DialerTask dt
  join DialerBusinessPoint dbp on dbp.BusinessPointID = dt.BusinessPointID
  join BusinessPoint bp on bp.ID = dbp.BusinessPointID
  join #bb b on b.BusinessPointCode = dbp.BusinessPointCode 
  join #AA aa on aa.cs_id = b.cs_id 
         and aa.TaskRnk = b.TaskRnk
         and aa.DateRnk = b.DateRnk  
  join Task tt on aa.ts_id = tt.id  
  join [case] cc on cc.ID = tt.CaseID
  join TargetGroupItemValue tgiv on tgiv.ID = cc.ContextEntityID and cc.ContextEntityType = 'TGIV'
  join [User] usr on tt.ActualOwnerID = usr.id
  left join #bbi2 bb on bb.BusinessPointCode = bp.code
  left join #aa aaa on aaa.BusinessPointCode = bb.BusinessPointCode
                    and aaa.TaskRnk = bb.TaskRnk
                    and aaa.DateRnk &lt;&gt; b.DateRnk  
  left join Task ttt on aaa.ts_id = ttt.id  
  left join [case] ccc on ccc.ID = ttt.CaseID
  left join TargetGroupItemValue tgiv2 on tgiv2.ID = ccc.ContextEntityID and ccc.ContextEntityType = 'TGIV'
  left join [User] usr1 on ttt.ActualOwnerID = usr1.id       

--select * from #tmp

  
  select distinct[Κωδ. ΕΣ],
         [Διακριτικος ΕΣ],
         [Φορολογική Επωνυμία ΕΣ],
         [ΣΔ],
         Case when [Αποτέλεσμα Κλήσης]  = 'ΑΔΥΝ' then 'Αδυναμία εύρεσης πελάτη' 
              when [Αποτέλεσμα Κλήσης]  = 'ΑΡΝ' then 'Άρνηση συνεργασίας' 
              when [Αποτέλεσμα Κλήσης] = 'ΑΡΝΕ' then 'Άρνηση επικοινωνίας'
              when [Αποτέλεσμα Κλήσης] = 'ΑΝΣΥ' then 'Αναμονή Συμβολαίου' 
              when [Αποτέλεσμα Κλήσης] = 'ΑΠΟΔΠ' then 'Αποδοχή Πρότασης'
              else [Αποτέλεσμα Κλήσης] end as 'Αποτέλεσμα Κλήσης',
         [Αιτία Αποτελέσματος] ,
         [Ημ/νια Τελ. Επανάκλησης],
         CreatedOn
    from #tmp t 
   where t.[Αποτέλεσμα Κλήσης] is not null 
     and not exists (select 1 
                       from #tmp t2
                      where t2.[Κωδ. ΕΣ] = t.[Κωδ. ΕΣ] 
                        and ((t2.[Αποτέλεσμα Κλήσης] = 'ΑΔΥΝ' and t2. [Αιτία Αποτελέσματος] = 'Fax') or
                              (t2.[Αποτέλεσμα Κλήσης] = 'ΑΔΥΝ' and t2. [Αιτία Αποτελέσματος] = 'Δεν απαντά') or
							  (t2.[Αποτέλεσμα Κλήσης] = 'ΑΔΥΝ' and t2. [Αιτία Αποτελέσματος] = 'Επανάκληση') or
							  (t2.[Αποτέλεσμα Κλήσης] = 'ΑΔΥΝ' and t2. [Αιτία Αποτελέσματος] = 'Τηλεφωνητής') or
							  (t2.[Αποτέλεσμα Κλήσης] = 'ΑΡΝ' and t2. [Αιτία Αποτελέσματος] = 'Τηλεφωνητής') or
							  (t2.[Αποτέλεσμα Κλήσης] = 'ΑΡΝ' and t2. [Αιτία Αποτελέσματος] = 'Fax') or
							  (t2.[Αποτέλεσμα Κλήσης] = 'ΑΡΝ' and t2. [Αιτία Αποτελέσματος] = 'Άμεση άρνηση') or
							  (t2.[Αποτέλεσμα Κλήσης] = 'ΑΡΝ' and t2. [Αιτία Αποτελέσματος] = 'Δεν απαντά') or
							  (t2.[Αποτέλεσμα Κλήσης] = 'ΑΡΝ' and t2. [Αιτία Αποτελέσματος] = 'Επανάκληση') or
							  (t2.[Αποτέλεσμα Κλήσης] = 'ΑΡΝ' and t2. [Αιτία Αποτελέσματος] = 'Κόλλημα Συμβούλου') or
							  (t2.[Αποτέλεσμα Κλήσης] = 'Επανάκληση' and t2. [Αιτία Αποτελέσματος] = 'Επανάκληση') or
							  (t2.[Αποτέλεσμα Κλήσης] = 'Επανάκληση' and t2. [Αιτία Αποτελέσματος] = 'Κόλλημα Συμβούλου') or
							  (t2.[Αποτέλεσμα Κλήσης] = 'Επανάκληση' and t2. [Αιτία Αποτελέσματος] = '') or
							  (t2.[Αποτέλεσμα Κλήσης] = 'Επανάκληση' and t2. [Αιτία Αποτελέσματος] = '-') or
							  (t2.[Αποτέλεσμα Κλήσης] = 'Επανάκληση' and t2. [Αιτία Αποτελέσματος] is null) ))
--and cast(t.CreatedOn as DATE) not between '2015-05-01' and '2015-05-31'  
--order by createdOn
   
     --and [Κωδ. ΕΣ] = 57893

   --order by 5--and t.[Αιτία Αποτελέσματος] is null
  
  --select * from #tmp t where t.[Αποτέλεσμα Κλήσης] is null where t.BusinessPointCode = 1675104
  
  --select count(t.BusinessPointCode),t.BusinessPointCode
  --  from #temp1 t
  --  group by t.BusinessPointCode
  --  having count(t.BusinessPointCode)&gt;1
  
  --select dt.*
  --  from DialerTask dt
  --  join DialerBusinessPoint dbp on dt.BusinessPointID = dbp.BusinessPointID
  -- where dbp.BusinessPointCode = 36301--dt.CurrentTaskID = 11001745--dbp.BusinessPointCode = 36301--dt.BusinessPointID = 26250  
  ---- where --dt.DialerCampaignID = 327
   
   
   
  -- select * from Task ts where ts.ID = 10364588
  -- select * from [Case] cs where cs.ID = 9538357
   
  -- select * 
  --   from TargetGroupItemValue tgiv
  --   join [Case] cs on tgiv.ID = cs.ContextEntityID 
  --                 and cs.ContextEntityType = 'TGIV'
  --   join Task ts on cs.ID = ts.CaseID
  --   where ts.ID = 10364588
     
     
  --   select distinct tt.id,tt.Description, tl.Outcome 
  --     from DialerTask dt join  Task t on dt.CurrentTaskID = t.id 
  --     join [Case] cs on t.CaseID = cs.id
  --     join TargetGroupItemValue tgiv on tgiv.ID = cs.ContextEntityID and cs.ContextEntityType = 'TGIV'
  --     join TaskType tt on t.TaskTypeID = tt.id
  --     join TaskLog tl on t.ID = tl.TaskID 
    
--select * from TaskLog tl where tl.TaskID in (9291008,
--9293121)

</CommandText>
      </Query>
      <Fields>
        <Field Name="Κωδ__ΕΣ">
          <DataField>Κωδ. ΕΣ</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Διακριτικος_ΕΣ">
          <DataField>Διακριτικος ΕΣ</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Φορολογική_Επωνυμία_ΕΣ">
          <DataField>Φορολογική Επωνυμία ΕΣ</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ΣΔ">
          <DataField>ΣΔ</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Αποτέλεσμα_Κλήσης">
          <DataField>Αποτέλεσμα Κλήσης</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Αιτία_Αποτελέσματος">
          <DataField>Αιτία Αποτελέσματος</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Ημ_νια_Τελ__Επανάκλησης">
          <DataField>Ημ/νια Τελ. Επανάκλησης</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="CreatedOn">
          <DataField>CreatedOn</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="DataSet1">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText>   select id, '['+convert(nvarchar(5),ID)+'] ' + Description as Campaign from DialerCampaign</CommandText>
      </Query>
      <Fields>
        <Field Name="Campaign">
          <DataField>Campaign</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="id">
          <DataField>id</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportParameters>
    <ReportParameter Name="Campaign">
      <DataType>Integer</DataType>
      <Prompt>Καμπάνια Dialer</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DataSet1</DataSetName>
          <ValueField>id</ValueField>
          <LabelField>Campaign</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
  </ReportParameters>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>3cf0cbcd-8b3b-4f69-876f-48855791b8fc</rd:ReportID>
</Report>